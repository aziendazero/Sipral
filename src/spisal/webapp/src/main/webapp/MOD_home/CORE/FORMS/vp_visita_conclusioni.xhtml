<div xmlns:ui="http://java.sun.com/jsf/facelets" xmlns:h="http://java.sun.com/jsf/html" xmlns:f="http://java.sun.com/jsf/core" xmlns:s="http://jboss.com/products/seam/taglib" xmlns:rich="http://richfaces.org/rich" xmlns:a4j="http://richfaces.org/a4j" xmlns:jstl="http://java.sun.com/jstl/core" style="height:100%;width:100%;">
			<a4j:outputPanel layout="block" id="LayoutRow_1503829062176" styleClass="layoutContainer layoutContainerVertical layoutRootVertical  layoutRoot layoutGroupBoxOuter" >
			<fieldset class="layoutGroupBox" ><legend class="groupBoxLegend" >${msg.LayoutRow_1503829062176}</legend>
				<a4j:outputPanel layout="block" id="LayoutRow_1504252585956" styleClass="layoutContainer layoutContainerVertical" >
 
					<a4j:outputPanel layout="block" styleClass="layoutVertical inputArea" id="TextArea_1504252592340" >
					<label >
						<span class="label">${msg.label_TextArea_1504252592340}</span>
						<div>
						<h:inputTextarea id="TextArea_1504252592340_id" value="#{ConclusioniMdl.diagnosiTxt}" label="${msg.label_TextArea_1504252592340}" rows="5" >
							<f:validateLength minimum="0" maximum="4000"/>
						</h:inputTextarea>
						</div>
					</label>
					<h:message style="float:left;" for="TextArea_1504252592340_id" styleClass="errorMessages TextArea_1504252592340_E" />
					</a4j:outputPanel>

				</a4j:outputPanel>
				<a4j:outputPanel layout="block" id="LayoutRow_1505033675932" style="padding-bottom:10px;" styleClass="layoutContainer layoutContainerVertical layoutGroupBoxOuter" >
				<fieldset class="layoutGroupBox" ><legend class="groupBoxLegend" >${msg.LayoutRow_1505033675932}</legend>
					<div class="layoutVertical" >
					<a4j:commandLink action="#{processManager.manageTask('NewDiag;BtnDiag')}" status="ajaxStatus" id="NewDiag" title="${msg.alt_NewDiag}" reRender="phiDesktop" styleClass="fa fa-plus fa-2x link" />
					</div>

					<a4j:outputPanel id="DataGrid_1506358919409" layout="block" styleClass="linkUnlink dt layoutTable layoutVertical" style="max-height:400px;overflow:auto;" >
						<table id="d1506358919409" cellspacing="0" cellpadding="0" summary="${msg.DataGrid_1506358919409} [DiagMdlList]" >
							<thead class="tableHeader">
								<tr>
									<th><a4j:commandLink id="DataGridColumn_1504979831216" value="${msg.DataGridColumn_1504979831216} &#8593;&#8595;" action="#{DiagMdlList.orderBy('icd9.code')}" reRender="DataGrid_1506358919409" ajaxSingle="true" disabled="#{empty DiagMdlList ? true : false}"/></th>
									<th><a4j:commandLink id="DataGridColumn_1503525819648" value="${msg.DataGridColumn_1503525819648} &#8593;&#8595;" action="#{DiagMdlList.orderBy(function.getLang('icd9.'))}" reRender="DataGrid_1506358919409" ajaxSingle="true" disabled="#{empty DiagMdlList ? true : false}"/></th>
									<th><a4j:commandLink id="DataGridColumn_1502372393502" value="${msg.DataGridColumn_1502372393502} &#8593;&#8595;" action="#{DiagMdlList.orderBy('inail.code')}" reRender="DataGrid_1506358919409" ajaxSingle="true" disabled="#{empty DiagMdlList ? true : false}"/></th>
									<th><a4j:commandLink id="DataGridColumn_1504168443393" value="${msg.DataGridColumn_1504168443393} &#8593;&#8595;" action="#{DiagMdlList.orderBy(function.getLang('inail.'))}" reRender="DataGrid_1506358919409" ajaxSingle="true" disabled="#{empty DiagMdlList ? true : false}"/></th>
									<th class="sortableColumn">${msg.DataGridColumn_1504524840641} &#8593;&#8595;</th>
									<th style="#{(Param['p.home.vp_pratica_workdisease.fattoreRischioDelete'].visible ? '' : 'display:none;')}" class="sortableColumn">${msg.DataGridColumn_1505364969893} &#8593;&#8595;</th>
								</tr>
							</thead>
							<tbody class="tableBody">
								<jstl:if test="#{empty DiagMdlList or DiagMdlList.isEmpty()}">
									<tr class="noresults">
										<td colspan="6">${error.emtpy_search_for_table}</td>
									</tr>
								</jstl:if>
								<a4j:repeat id="r1506358919409" value="#{DiagMdlList.entities}" var="DiagMdl" rowKeyVar="rowIndex" >
									<tr >
										<td >
											#{DiagMdl.icd9.code}
										</td>

										<td >
											#{DiagMdl.icd9.currentTranslation}
										</td>

										<td >
											#{DiagMdl.inail.code}
										</td>

										<td >
											#{DiagMdl.inail.currentTranslation}
										</td>

										<td >
											<a4j:commandLink action="#{DiagMdlAction.injectAndProceed(DiagMdl, 'MngDiag;BtnDiag')}" status="ajaxStatus" id="MngDiag" title="${msg.alt_MngDiag}" reRender="phiDesktop" styleClass="fa fa-pencil-square-o fa-2x linkUnlink readOnly tableButton" />

										</td>

										<td style="#{(Param['p.home.vp_pratica_workdisease.fattoreRischioDelete'].visible ? '' : 'display:none;')} " >
											<a4j:commandLink action="#{DiagMdlAction.injectAndProceed(DiagMdl, 'DelDiag;BtnDiag')}" status="ajaxStatus" id="DelDiag" title="${msg.alt_DelDiag}" reRender="phiDesktop" styleClass="fa fa-trash fa-2x linkUnlink tableButton" />

										</td>

									</tr>
								</a4j:repeat>
							</tbody>
						</table>
					</a4j:outputPanel>

				</fieldset>
				</a4j:outputPanel>
				<a4j:outputPanel layout="block" id="LayoutRow_1504252586461" style="padding-bottom:10px;" styleClass="layoutContainer layoutContainerVertical" >
					<div class="layoutHorizontal" >
					<label >
						<span class="label">${msg.label_MonthCalendar_1504532062135}</span>
						<h:inputText id="MonthCalendar_1504532062135" value="#{ConclusioniMdl.conclusioneVisita}" class="datepicker  monthCalendar" style="vertical-align:middle;" label="${msg.label_MonthCalendar_1504532062135}" rerender="LayoutRow_1504532363133" onchange="updateControlloDates(this,'#'+getIdPrefix(this)+'TextBox_1504532133575','#'+getIdPrefix(this)+'MonthCalendar_1504532198639',this)"  autocomplete="off" >
						<s:convertDateTime pattern="${format.dateNormal}" />
						</h:inputText>
						<i class="ui-datepicker-trigger" onclick="showDateTimePicker(this);"  />
						<h:message style="float:left;" for="MonthCalendar_1504532062135" styleClass="errorMessages MonthCalendar_1504532062135_E" />
					</label>
					</div>

					<div class="layoutHorizontal" >
					<label style="display:block;" >
						<span class="widget-label">${msg.label_TextBox_1504532133575}</span>
						<h:inputText id="TextBox_1504532133575" value="#{ConclusioniMdl.ggControlli}" styleClass="inputText" label="${msg.label_TextBox_1504532133575}" onkeyup="updateControlloDates('#'+getIdPrefix(this)+'MonthCalendar_1504532062135',this,'#'+getIdPrefix(this)+'MonthCalendar_1504532198639',this)">
						<f:converter converterId="IntegerConverter"/>
					</h:inputText>
						<a4j:outputPanel id="TextBox_1504532133575_msg" styleClass="errorContainer" ><h:message for="TextBox_1504532133575" styleClass="errorMessages TextBox_1504532133575_E" /></a4j:outputPanel>
					</label>
					</div>

					<div class="layoutHorizontal" >
					<label >
						<span class="label">${msg.label_MonthCalendar_1504532198639}</span>
						<h:inputText id="MonthCalendar_1504532198639" value="#{ConclusioniMdl.controllo}" class="datepicker  monthCalendar" style="vertical-align:middle;" label="${msg.label_MonthCalendar_1504532198639}" onchange="updateControlloDates('#'+getIdPrefix(this)+'MonthCalendar_1504532062135','#'+getIdPrefix(this)+'TextBox_1504532133575',this,this)"  autocomplete="off" >
						<s:convertDateTime pattern="${format.dateNormal}" />
						</h:inputText>
						<i class="ui-datepicker-trigger" onclick="showDateTimePicker(this);"  />
						<h:message style="float:left;" for="MonthCalendar_1504532198639" styleClass="errorMessages MonthCalendar_1504532198639_E" />
					</label>
					</div>

					<div class="layoutHorizontal" >
					<a4j:outputPanel layout="block" id="JollyWidget_1504413013813" style="height:100%;width:100%;" >
						<script type="text/javascript">
						//<![CDATA[
						function updateControlloDates(lowerElement, middleElement, higherElement, changingElement) {
						debugger;
						   dateCompare(lowerElement,higherElement);
								
							var lowerWidget = jQuery(lowerElement);
							if (lowerWidget.length > 0 && lowerWidget.is('div')) {
								lowerWidget = lowerWidget.children('input:first');
							}
							
							var middleWidget = jQuery(middleElement);
							if (middleWidget.length > 0 && middleWidget.is('div')) {
								middleWidget = middleWidget.children('input:first');
							}
							
							var higherWidget = jQuery(higherElement);
							if (higherWidget.length > 0 && higherWidget.is('div')) {
								higherWidget = higherWidget.children('input:first');
							}
							
							var jLowerWidget = jQuery(lowerWidget);
							var lowerValue = jLowerWidget.datepicker('getDate');
							
							var jHigherWidget = jQuery(higherWidget);
							var higherValue = jHigherWidget.datepicker('getDate');
						
							var middleValue = middleWidget.val();
						
							switch(changingElement){
								case lowerElement:
									if(higherValue){
										middleValue = getDaysDiffBetween(lowerValue,higherValue);
										middleWidget.val(middleValue);
									}else if(middleValue) {
										higherValue = addDays(lowerValue,middleValue);
										jHigherWidget.datepicker('setDate', higherValue);
									}
								
									break;
								case middleElement:
									if(lowerValue){
										higherValue = addDays(lowerValue,middleValue);
										jHigherWidget.datepicker('setDate', higherValue);
									}
								
									break;
								case higherElement:
									if(lowerValue){
										middleValue = getDaysDiffBetween(lowerValue,higherValue);
										middleWidget.val(middleValue);
									}
								
									break;
							}
						}
						
						function getDaysDiffBetween(date1, date2){
						debugger;
						  if (date1==null || date2==null)
							return;
							var timeDiff = Math.abs(date2.getTime() - date1.getTime());
							var diffDays = Math.ceil(timeDiff / (1000 * 3600 * 24)); 
							return diffDays;
						}
						
						function addDays(date, days) {
						debugger;
						  if (date==null || days==null)
							return;
						  var result = new Date(date);
						  result.setDate(result.getDate() + Number(days));
						  return result;
						}
						
						//]]>
						</script>
					</a4j:outputPanel>
					</div>

				</a4j:outputPanel>
				<a4j:outputPanel layout="block" id="LayoutRow_1504532218061" style="padding-bottom:10px;" styleClass="layoutContainer layoutContainerVertical" >
					<div class="layoutHorizontal" >
					<label >
						<span class="label">${msg.label_MonthCalendar_1504532224798}</span>
						<h:inputText id="MonthCalendar_1504532224798" value="#{ConclusioniMdl.uscitaFollowUp}" class="datepicker  monthCalendar" style="vertical-align:middle;" label="${msg.label_MonthCalendar_1504532224798}"  autocomplete="off" >
						<s:convertDateTime pattern="${format.dateNormal}" />
						</h:inputText>
						<i class="ui-datepicker-trigger" onclick="showDateTimePicker(this);"  />
						<h:message style="float:left;" for="MonthCalendar_1504532224798" styleClass="errorMessages MonthCalendar_1504532224798_E" />
					</label>
					</div>

 
					<a4j:outputPanel layout="block" styleClass="layoutHorizontal inputArea" id="TextArea_1504532305213" >
					<label >
						<span class="label">${msg.label_TextArea_1504532305213}</span>
						<div>
						<h:inputTextarea id="TextArea_1504532305213_id" value="#{ConclusioniMdl.uscitaFollowUpTxt}" label="${msg.label_TextArea_1504532305213}" rows="5" >
							<f:validateLength minimum="0" maximum="4000"/>
						</h:inputTextarea>
						</div>
					</label>
					<h:message style="float:left;" for="TextArea_1504532305213_id" styleClass="errorMessages TextArea_1504532305213_E" />
					</a4j:outputPanel>

				</a4j:outputPanel>
				<a4j:outputPanel layout="block" style="padding:0;" id="LayoutRow_1504532426619" styleClass="layoutContainer layoutContainerVertical" >
				<a4j:outputPanel layout="block" style="width:100%;height:100%" rendered="#{MedicinaLavoro.type.code eq '05'}" >
				<fieldset class="layoutGroupBox" ><legend class="groupBoxLegend" >${msg.LayoutRow_1504532426619}</legend>
					<a4j:outputPanel layout="block" id="LayoutRow_1504532363133" style="padding-bottom:10px;" styleClass="layoutContainer layoutContainerVertical" >
						<div class="layoutHorizontal" >
						<h:selectOneMenu id="ComboBox_1504532328720" value="#{ConclusioniMdl.idoneitaMdl}" styleClass="comboBox" >
							<f:selectItem itemLabel="-" itemValue=""/>
							<f:selectItems value="#{vocabularies.getIdValues('PHIDIC:IdoneitaMdl')}" />
							<f:converter converterId="CodeValueConverter"/>
							<a4j:support limitToList="true" ajaxSingle="true" reRender="LayoutRow_1505988234032" event="onchange" ignoreDupResponses="true" />
						</h:selectOneMenu>
						</div>

						<a4j:outputPanel layout="block" style="padding:0;" id="LayoutRow_1505988234032" styleClass="layoutContainer layoutContainerHorizontal" >
						<a4j:outputPanel layout="block" style="width:100%;height:100%" rendered="#{ConclusioniMdl.idoneitaMdl.code eq '02' or ConclusioniMdl.idoneitaMdl.code eq '04'}" >
							<div class="layoutHorizontal" >
							<label style="display:block;" >
								<span class="widget-label">${msg.label_TextBox_1504532431099}</span>
								<h:inputText id="TextBox_1504532431099" value="#{ConclusioniMdl.durataMesi}" styleClass="inputText" label="${msg.label_TextBox_1504532431099}" onkeyup="updateScadenza('#'+getIdPrefix(this)+'MonthCalendar_1504532062135','#'+getIdPrefix(this)+'TextBox_1504532431099','#'+getIdPrefix(this)+'MonthCalendar_1504532458851')">
								<f:converter converterId="IntegerConverter"/>
							</h:inputText>
								<a4j:outputPanel id="TextBox_1504532431099_msg" styleClass="errorContainer" ><h:message for="TextBox_1504532431099" styleClass="errorMessages TextBox_1504532431099_E" /></a4j:outputPanel>
							</label>
							</div>
							<script>setDefaultValue('TextBox_1504532431099','0')</script>

							<div class="layoutHorizontal" >
							<label >
								<span class="label">${msg.label_MonthCalendar_1504532458851}</span>
								<h:inputText id="MonthCalendar_1504532458851" value="#{ConclusioniMdl.scadenza}" class="datepicker  monthCalendar" style="vertical-align:middle;" label="${msg.label_MonthCalendar_1504532458851}"  autocomplete="off" >
								<s:convertDateTime pattern="${format.dateNormal}" />
								</h:inputText>
								<i class="ui-datepicker-trigger" onclick="showDateTimePicker(this);"  />
								<h:message style="float:left;" for="MonthCalendar_1504532458851" styleClass="errorMessages MonthCalendar_1504532458851_E" />
							</label>
							</div>

						</a4j:outputPanel>
						</a4j:outputPanel>
						<div class="layoutHorizontal" >
						<a4j:outputPanel layout="block" id="JollyWidget_1505988061572" style="height:100%;width:100%;" >
							<script type="text/javascript">
							//<![CDATA[
							
							
							function updateScadenza(dataConclusioneId, mesiId, dataScadenzaId) {
								debugger;
							    var dataConclusioneElement = jQuery(dataConclusioneId.replace( /(:|\.|\[|\]|,|=|@)/g, "\\$1" ));
								var mesiElement = jQuery(mesiId.replace( /(:|\.|\[|\]|,|=|@)/g, "\\$1" ));
								var dataScadenzaElement = jQuery(dataScadenzaId.replace( /(:|\.|\[|\]|,|=|@)/g, "\\$1" ));
								var newDate = addDays(dataConclusioneElement.datepicker('getDate'),mesiElement.val()*30);
								dataScadenzaElement.datepicker('setDate', newDate);
							}
							
							
							//]]>
							</script>
						</a4j:outputPanel>
						</div>

					</a4j:outputPanel>
 
					<h:outputLabel layout="block" styleClass="widgetDiv"  for="TextArea_1504532398916_id" style="display:none;" value="hiddenLabel"></h:outputLabel>
					<a4j:outputPanel layout="block" styleClass="layoutVertical inputArea" id="TextArea_1504532398916" >
					<h:inputTextarea id="TextArea_1504532398916_id" value="#{ConclusioniMdl.note}" rows="5" >
						<f:validateLength minimum="0" maximum="4000"/>
					</h:inputTextarea>
					<h:message style="float:left;" for="TextArea_1504532398916_id" styleClass="errorMessages TextArea_1504532398916_E" />
					</a4j:outputPanel>

				</fieldset>
				</a4j:outputPanel>
				</a4j:outputPanel>
			</fieldset>
			</a4j:outputPanel>

	<script>focusFirstElement();</script>
</div>
