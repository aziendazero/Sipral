<div xmlns:ui="http://java.sun.com/jsf/facelets" xmlns:h="http://java.sun.com/jsf/html" xmlns:f="http://java.sun.com/jsf/core" xmlns:s="http://jboss.com/products/seam/taglib" xmlns:rich="http://richfaces.org/rich" xmlns:a4j="http://richfaces.org/a4j" xmlns:jstl="http://java.sun.com/jstl/core" style="height:100%;width:100%;">
			<a4j:outputPanel layout="block" id="LayoutRow_1506366411800" styleClass="layoutContainer layoutContainerVertical layoutRootVertical  layoutRoot layoutGroupBoxOuter" >
			<fieldset class="layoutGroupBox" ><legend class="groupBoxLegend" >${msg.LayoutRow_1506366411800}</legend>
				<a4j:outputPanel layout="block" id="LayoutRow_1505640482768" styleClass="layoutContainer layoutContainerVertical" >
 
					<a4j:outputPanel layout="block" styleClass="layoutVertical inputArea" id="TextArea_1505391769520" >
					<label >
						<span class="label">${msg.label_TextArea_1505391769520}</span>
						<div>
						<h:inputTextarea id="TextArea_1505391769520_id" value="#{ValutazioneConclusivaMdl.diagnosiTxt}" label="${msg.label_TextArea_1505391769520}" rows="5">
							<f:validateLength minimum="0" maximum="4000"/>
						</h:inputTextarea>
						</div>
					</label>
					<h:message style="float:left;" for="TextArea_1505391769520_id" styleClass="errorMessages TextArea_1505391769520_E" />
					</a4j:outputPanel>

				</a4j:outputPanel>
				<a4j:outputPanel layout="block" id="LayoutRow_1505849353712" style="padding-bottom:20px;" styleClass="layoutContainer layoutContainerVertical" >
 
					<a4j:outputPanel layout="block" styleClass="layoutVertical inputArea" id="TextArea_1505220969092" >
					<label >
						<span class="label">${msg.label_TextArea_1505220969092}</span>
						<div>
						<h:inputTextarea id="TextArea_1505220969092_id" value="#{Procpratiche.conclusioni}" label="${msg.label_TextArea_1505220969092}" rows="5">
							<f:validateLength minimum="0" maximum="2500"/>
						</h:inputTextarea>
						</div>
					</label>
					<h:message style="float:left;" for="TextArea_1505220969092_id" styleClass="errorMessages TextArea_1505220969092_E" />
					</a4j:outputPanel>

					<div class="layoutVertical" >
					<h:selectBooleanCheckbox id="CheckBox_1505220980825" value="#{Procpratiche.conclusioniBl}" style="vertical-align:middle;" styleClass="c-text-bold checkBox" alt="CHECKBOX" label="${msg.CheckBox_1505220980825}" />
					<h:outputLabel value="${msg.CheckBox_1505220980825}" for="CheckBox_1505220980825" style="vertical-align:middle;margin-left:3px;" />
					<h:message for="CheckBox_1505220980825" styleClass="errorMessages CheckBox_1505220980825_E" />
					</div>
					<h:outputLabel layout="block" styleClass="widgetDiv"  for="CheckBox_1505220980825" style="display:none;" value="hiddenLabel"></h:outputLabel>
				</a4j:outputPanel>
				<a4j:outputPanel layout="block" id="LayoutRow_1506294147730" style="padding-bottom:10px;" styleClass="layoutContainer layoutContainerVertical layoutGroupBoxOuter" >
				<fieldset class="layoutGroupBox" ><legend class="groupBoxLegend" >${msg.LayoutRow_1506294147730}</legend>
					<div class="layoutVertical" >
					<a4j:commandLink action="#{processManager.manageTask('NewDiag;BtnMdl')}" status="ajaxStatus" id="NewDiag" title="${msg.alt_NewDiag}" reRender="phiDesktop" styleClass="fa fa-plus fa-2x link" />
					</div>

					<a4j:outputPanel id="DataGrid_1503286358310" layout="block" styleClass="linkUnlink dt layoutTable layoutVertical" style="max-height:400px;overflow:auto;" >
						<table id="d1503286358310" cellspacing="0" cellpadding="0" summary="${msg.DataGrid_1503286358310} [DiagMdlList]" >
							<thead class="tableHeader">
								<tr>
									<th><a4j:commandLink id="DataGridColumn_1507182107306" value="${msg.DataGridColumn_1507182107306} &#8593;&#8595;" action="#{DiagMdlList.orderBy('icd9.code')}" reRender="DataGrid_1503286358310" ajaxSingle="true" disabled="#{empty DiagMdlList ? true : false}"/></th>
									<th><a4j:commandLink id="DataGridColumn_1506232842700" value="${msg.DataGridColumn_1506232842700} &#8593;&#8595;" action="#{DiagMdlList.orderBy(function.getLang('icd9.'))}" reRender="DataGrid_1503286358310" ajaxSingle="true" disabled="#{empty DiagMdlList ? true : false}"/></th>
									<th><a4j:commandLink id="DataGridColumn_1505410225716" value="${msg.DataGridColumn_1505410225716} &#8593;&#8595;" action="#{DiagMdlList.orderBy('inail.code')}" reRender="DataGrid_1503286358310" ajaxSingle="true" disabled="#{empty DiagMdlList ? true : false}"/></th>
									<th><a4j:commandLink id="DataGridColumn_1503084453209" value="${msg.DataGridColumn_1503084453209} &#8593;&#8595;" action="#{DiagMdlList.orderBy(function.getLang('inail.'))}" reRender="DataGrid_1503286358310" ajaxSingle="true" disabled="#{empty DiagMdlList ? true : false}"/></th>
									<th class="sortableColumn">${msg.DataGridColumn_1503859776495} &#8593;&#8595;</th>
									<th style="#{(Param['p.home.vp_pratica_workdisease.fattoreRischioDelete'].visible ? '' : 'display:none;')}" class="sortableColumn">${msg.DataGridColumn_1504995870334} &#8593;&#8595;</th>
								</tr>
							</thead>
							<tbody class="tableBody">
								<jstl:if test="#{empty DiagMdlList or DiagMdlList.isEmpty()}">
									<tr class="noresults">
										<td colspan="6">${error.emtpy_search_for_table}</td>
									</tr>
								</jstl:if>
								<a4j:repeat id="r1503286358310" value="#{DiagMdlList.entities}" var="DiagMdl" rowKeyVar="rowIndex" >
									<tr >
										<td >
											#{DiagMdl.icd9.code}
										</td>

										<td >
											#{DiagMdl.icd9.currentTranslation}
										</td>

										<td >
											#{DiagMdl.inail.code}
										</td>

										<td >
											#{DiagMdl.inail.currentTranslation}
										</td>

										<td >
											<a4j:commandLink action="#{DiagMdlAction.injectAndProceed(DiagMdl, 'MngDiag;BtnMdl')}" status="ajaxStatus" id="MngDiag" title="${msg.alt_MngDiag}" reRender="phiDesktop" styleClass="fa fa-pencil-square-o fa-2x linkUnlink tableButton" />

										</td>

										<td style="#{(Param['p.home.vp_pratica_workdisease.fattoreRischioDelete'].visible ? '' : 'display:none;')} " >
											<a4j:commandLink action="#{DiagMdlAction.injectAndProceed(DiagMdl, 'DelDiag;BtnMdl')}" status="ajaxStatus" id="DelDiag" title="${msg.alt_DelDiag}" reRender="phiDesktop" styleClass="fa fa-trash fa-2x linkUnlink tableButton" />

										</td>

									</tr>
								</a4j:repeat>
							</tbody>
						</table>
					</a4j:outputPanel>

				</fieldset>
				</a4j:outputPanel>
				<a4j:outputPanel layout="block" style="padding-bottom:10px;padding:0;" id="LayoutRow_1505644167871" styleClass="layoutContainer layoutContainerVertical" >
				<a4j:outputPanel layout="block" style="width:100%;height:100%" rendered="#{MedicinaLavoro.type.code eq '05'}" >
					<div class="layoutHorizontal" >
					<label >
						<span class="label">${msg.label_ComboBox_1507158611749}</span>
						<h:selectOneMenu id="ComboBox_1507158611749" value="#{ValutazioneConclusivaMdl.idoneitaMdl}" styleClass="comboBox" label="${msg.label_ComboBox_1507158611749}" >
							<f:selectItem itemLabel="-" itemValue=""/>
							<f:selectItems value="#{vocabularies.getIdValues('PHIDIC:IdoneitaMdl')}" />
							<f:converter converterId="CodeValueConverter"/>
						</h:selectOneMenu>
					</label>
					</div>

				</a4j:outputPanel>
				</a4j:outputPanel>
				<a4j:outputPanel layout="block" id="LayoutRow_1506958169465" style="padding-bottom:10px;" styleClass="layoutContainer layoutContainerVertical" >
					<div class="layoutHorizontal" >
					<label >
						<span class="label">${msg.label_MonthCalendar_1504491690959}</span>
						<h:inputText id="MonthCalendar_1504491690959" value="#{ValutazioneConclusivaMdl.conclusioneVisita}" class="datepicker  monthCalendar" style="vertical-align:middle;" label="${msg.label_MonthCalendar_1504491690959}" onchange="updateControlloDates(this,'#'+getIdPrefix(this)+'TextBox_1504612482038','#'+getIdPrefix(this)+'MonthCalendar_1503107046059',this)"  autocomplete="off" >
						<s:convertDateTime pattern="${format.dateNormal}" />
						</h:inputText>
						<i class="ui-datepicker-trigger" onclick="showDateTimePicker(this);"  />
						<h:message style="float:left;" for="MonthCalendar_1504491690959" styleClass="errorMessages MonthCalendar_1504491690959_E" />
					</label>
					</div>

					<div class="layoutHorizontal" >
					<label style="display:block;" >
						<span class="widget-label">${msg.label_TextBox_1504612482038}</span>
						<h:inputText id="TextBox_1504612482038" value="#{ValutazioneConclusivaMdl.ggControlli}" styleClass="inputText" label="${msg.label_TextBox_1504612482038}" onkeyup="updateControlloDates('#'+getIdPrefix(this)+'MonthCalendar_1504491690959',this,'#'+getIdPrefix(this)+'MonthCalendar_1503107046059',this)">
						<f:converter converterId="IntegerConverter"/>
					</h:inputText>
						<a4j:outputPanel id="TextBox_1504612482038_msg" styleClass="errorContainer" ><h:message for="TextBox_1504612482038" styleClass="errorMessages TextBox_1504612482038_E" /></a4j:outputPanel>
					</label>
					</div>

					<div class="layoutHorizontal" >
					<label >
						<span class="label">${msg.label_MonthCalendar_1503107046059}</span>
						<h:inputText id="MonthCalendar_1503107046059" value="#{ValutazioneConclusivaMdl.controllo}" class="datepicker  monthCalendar" style="vertical-align:middle;" label="${msg.label_MonthCalendar_1503107046059}" onchange="updateControlloDates('#'+getIdPrefix(this)+'MonthCalendar_1504491690959','#'+getIdPrefix(this)+'TextBox_1504612482038',this,this)"  autocomplete="off" >
						<s:convertDateTime pattern="${format.dateNormal}" />
						</h:inputText>
						<i class="ui-datepicker-trigger" onclick="showDateTimePicker(this);"  />
						<h:message style="float:left;" for="MonthCalendar_1503107046059" styleClass="errorMessages MonthCalendar_1503107046059_E" />
					</label>
					</div>

					<div class="layoutHorizontal" >
					<a4j:outputPanel layout="block" id="JollyWidget_1507070458994" style="height:100%;width:100%;" >
						<script type="text/javascript"><![CDATA[
						function updateControlloDates(lowerElement, middleElement, higherElement, changingElement) {
							dateCompare(lowerElement,higherElement);
								
							var lowerWidget = jQuery(lowerElement);
							if (lowerWidget.length > 0 && lowerWidget.is('div')) {
								lowerWidget = lowerWidget.children('input:first');
							}
							
							var middleWidget = jQuery(middleElement);
							if (middleWidget.length > 0 && middleWidget.is('div')) {
								middleWidget = middleWidget.children('input:first');
							}
							
							var higherWidget = jQuery(higherElement);
							if (higherWidget.length > 0 && higherWidget.is('div')) {
								higherWidget = higherWidget.children('input:first');
							}
							
							var jLowerWidget = jQuery(lowerWidget);
							var lowerValue = jLowerWidget.datepicker('getDate');
							
							var jHigherWidget = jQuery(higherWidget);
							var higherValue = jHigherWidget.datepicker('getDate');
						
							var middleValue = middleWidget.val();
						
							switch(changingElement){
								case lowerElement:
									if(higherValue){
										middleValue = getWorkingDays(lowerValue,higherValue);
										middleWidget.val(middleValue);
									}else if(middleValue) {
										higherValue = addWorkingDays(lowerValue,middleValue);
										jHigherWidget.datepicker('setDate', higherValue);
									}
								
									break;
								case middleElement:
									if(lowerValue){
										higherValue = addWorkingDays(lowerValue,middleValue);
										jHigherWidget.datepicker('setDate', higherValue);
									}
								
									break;
								case higherElement:
									if(lowerValue){
										middleValue = getWorkingDays(lowerValue,higherValue);
										middleWidget.val(middleValue);
									}
								
									break;
							}
						}
						
						function addWorkingDays(start, days){
							if(start && days){
								var currWeekDay=0;
								var currMonthDay=0;
								var currMonth=0;
								var currYear=0;
								var easter=[1,2];
								var stop = new Date(start.getTime());
								
								while(days>0){
									stop.setTime(stop.getTime()+1000*60*60*24);
									
									currWeekDay=stop.getDay();
									currMonthDay=stop.getDate();
									currMonth=stop.getMonth();
									if(stop.getFullYear()!=currYear){
										currYear=stop.getFullYear();
										easter=getEaster(currYear);
										if(easter[1]==2 && easter[0]==31){
											easter[1]=3;
											easter[0]=1;
										}else{
											easter[0]++;
										}
									}
									
									if(currWeekDay==0 || currWeekDay==6){
										continue;	//sabato e domenica
									}else if(currMonth==0){
										if(currMonthDay==1 || currMonthDay==6)
											continue;	//capodanno ed epifania
									}else if(currMonth==3){
										if(currMonthDay==25)
											continue;	//liberazione
									}else if(currMonth==easter[1]){
										if(currMonthDay==easter[0]){
											continue;	//lunedi di pasqua
										}
									}else if(currMonth==4){
										if(currMonthDay==1)
											continue;	//lavoro
									}else if(currMonth==5){
										if(currMonthDay==2)
											continue;	//repubblica
									}else if(currMonth==7){
										if(currMonthDay==15)
											continue;	//assunzione
									}else if(currMonth==10){
										if(currMonthDay==1)
											continue;	//ognissanti
									}else if(currMonth==11){
										if(currMonthDay==8 || currMonthDay==25 || currMonthDay==26)
											continue;	//immacolata, natale, s.stefano
									}
						
									days--;
								}
								
								return stop;
							}
						}
						
						function getWorkingDays(start, high){
							if(start && high){
								var stop = new Date(high.getTime());
								var currWeekDay=0;
								var currMonthDay=0;
								var currMonth=0;
								var currYear=0;
								var easter=[1,2];
								var days = 0;
								
								while(stop-start>0){
									stop.setTime(stop.getTime()-1000*60*60*24);
									
									currWeekDay=stop.getDay();
									currMonthDay=stop.getDate();
									currMonth=stop.getMonth();
									if(stop.getFullYear()!=currYear){
										currYear=stop.getFullYear();
										easter=getEaster(currYear);
										if(easter[1]==2 && easter[0]==31){
											easter[1]=3;
											easter[0]=1;
										}else{
											easter[0]++;
										}
									}
									
									if(currWeekDay==0 || currWeekDay==6){
										continue;	//sabato e domenica
									}else if(currMonth==0){
										if(currMonthDay==1 || currMonthDay==6)
											continue;	//capodanno ed epifania
									}else if(currMonth==3){
										if(currMonthDay==25)
											continue;	//liberazione
									}else if(currMonth==easter[1]){
										if(currMonthDay==easter[0]){
											continue;	//lunedi di pasqua
										}
									}else if(currMonth==4){
										if(currMonthDay==1)
											continue;	//lavoro
									}else if(currMonth==5){
										if(currMonthDay==2)
											continue;	//repubblica
									}else if(currMonth==7){
										if(currMonthDay==15)
											continue;	//assunzione
									}else if(currMonth==10){
										if(currMonthDay==1)
											continue;	//ognissanti
									}else if(currMonth==11){
										if(currMonthDay==8 || currMonthDay==25 || currMonthDay==26)
											continue;	//immacolata, natale, s.stefano
									}
						
									days++;
								}
								
								return days;
							}
						}
						
						function getEaster(n){
							easter = [1,2];
							var x=24;
							var y=5;
							
							var a=n%19;
							var b=n%4;
							var c=n%7;
							var d=(19*a+x)%30;
							var e=(2*b+4*c+6*d+y)%7;
							
							var sum1=22+d+e;
							var sum2=sum1-31;
							if(sum1<=31){
								easter[0]=sum1;
							}else if(sum1>31){
								easter[1]=3;
								if(sum2!=25 && sum2!=26){
									easter[0]=sum2;
								}else if(sum2==25 && (d!=28 || a<=10)){
									easter[0]=sum2;
								}else if(sum2==25 && d==28 && a>10){
									easter[0]=18;
								}else if(sum2==26){
									easter[0]=19;
								}
							}
							
							return easter;
						}
						]]></script>
					</a4j:outputPanel>
					</div>

				</a4j:outputPanel>
				<a4j:outputPanel layout="block" id="LayoutRow_1506912952793" style="padding-bottom:10px;" styleClass="layoutContainer layoutContainerVertical" >
					<div class="layoutHorizontal" >
					<label >
						<span class="label">${msg.label_MonthCalendar_1506320585949}</span>
						<h:inputText id="MonthCalendar_1506320585949" value="#{ValutazioneConclusivaMdl.uscitaFollowUp}" class="datepicker  monthCalendar" style="vertical-align:middle;" label="${msg.label_MonthCalendar_1506320585949}"  autocomplete="off" >
						<s:convertDateTime pattern="${format.dateNormal}" />
						</h:inputText>
						<i class="ui-datepicker-trigger" onclick="showDateTimePicker(this);"  />
						<h:message style="float:left;" for="MonthCalendar_1506320585949" styleClass="errorMessages MonthCalendar_1506320585949_E" />
					</label>
					</div>

 
					<a4j:outputPanel layout="block" styleClass="layoutHorizontal inputArea" id="TextArea_1506849758917" >
					<label >
						<span class="label">${msg.label_TextArea_1506849758917}</span>
						<div>
						<h:inputTextarea id="TextArea_1506849758917_id" value="#{ValutazioneConclusivaMdl.uscitaFollowUpTxt}" label="${msg.label_TextArea_1506849758917}" rows="3" >
							<f:validateLength minimum="0" maximum="4000"/>
						</h:inputTextarea>
						</div>
					</label>
					<h:message style="float:left;" for="TextArea_1506849758917_id" styleClass="errorMessages TextArea_1506849758917_E" />
					</a4j:outputPanel>

				</a4j:outputPanel>
			</fieldset>
			</a4j:outputPanel>

	<script>focusFirstElement();</script>
</div>
